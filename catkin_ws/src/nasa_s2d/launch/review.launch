<?xml version="1.0" encoding="UTF-8"?>
<launch>

    <arg name="bagroot"             default="$(eval env('HOME') + '/Documents/bags/nasa/')" />
    <arg name="bagname"             default="run3.bag" />
    <arg name="bagpath"             default="$(arg bagroot)/$(arg bagname)" />
    <arg name="hide_bag"            default="false" />
    <arg name="show3d"              default="true" />
    <!-- <arg name="show_dashboard"      default="true" /> -->
    <!-- <arg name="tuning"              default="true" /> -->
    <!-- <arg name="ns"                  default="review" /> -->

    <!-- ###################################################################### -->

    <!-- make all nodes use sim time -->
    <param name="use_sim_time" type="bool" value="true" />

    <!-- launch-prefix settings for xterm, with ability to be hidden -->
    <arg if="$(arg hide_bag)"     name="prefix" value="" />
    <arg unless="$(arg hide_bag)" name="prefix" value="xterm -hold -geometry 100x20 -e" />

    <!-- The video in the rosbag is compressed - this decompresses it for visual_mtt -->
<!--     <node pkg="image_transport" type="republish" name="decompress" output="log" args="compressed in:=camera/image_raw out:=$(arg ns)/camera/image_raw" /> -->

    <!-- Play the selected rosbag. Also, remap the camera_info topic into the review namespace -->
    <node pkg="rosbag" type="play" name="player" args="--pause $(arg bagpath) --clock" launch-prefix="$(arg prefix)">
      <!-- <remap `from="camera/camera_info" to="$(arg ns)/camera/camera_info" /> -->
      <!-- <rem`ap from="/tf" to="/tf_old" /> -->
    </node>

    <!-- HUD -->
    <node pkg="hud" type="hud" name="hud">
        <remap from="odom" to="/mavros/local_position/odom" />
        <param name="image_transport" value="compressed" />
    </node>


    <!-- rviz 3d visualization of geolocated tracks -->
    <group if="$(arg show3d)">
        <node pkg="flat_earth_geolocation" type="plotter" name="plotter" output="screen">
            <remap from="tracks" to="tracks3d" />
        </node>

        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find nasa_s2d)/rviz/s2d_geolocation.rviz" />
    </group>


</launch>
